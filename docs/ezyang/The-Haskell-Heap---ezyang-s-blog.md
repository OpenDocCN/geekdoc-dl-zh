<!--yml

分类：未分类

日期：2024-07-01 18:17:53

-->

# Haskell 堆：ezyang 的博客

> 来源：[`blog.ezyang.com/2011/04/the-haskell-heap/`](http://blog.ezyang.com/2011/04/the-haskell-heap/)

## Haskell 堆

Haskell 堆是一个相当奇怪的地方。它不像传统、严格求值语言的堆...

...里面装了很多垃圾！（普通的旧数据。）

在 Haskell 堆中，每个项目都被精美地包裹在一个盒子里：Haskell 堆是一个*礼物*（thunk）的堆。

当你实际上想要礼物里面的东西时，你*打开它*（评估它）。

礼物通常有名字，有时候你打开一个礼物时会得到一个*礼品卡*（数据构造器）。礼品卡有两个特点：它们有一个名字（`Just` 礼品卡或 `Right` 礼品卡），并告诉你其他礼物在哪里。可能会有多个（元组礼品卡），如果你很幸运！

但是就像礼品卡可以闲置在一旁一样（这就是礼品卡公司赚钱的方式！），你不必兑现那些礼物。

Haskell 堆上的礼物相当调皮。有些礼物在你打开它们时会爆炸，而其他一些则被幽灵所缠绕，当被打扰时会打开其他的礼物。

理解当你打开一个礼物时发生的情况对于理解 Haskell 程序的时间和空间行为至关重要。

在这个系列中，Edward 进入了网络漫画世界，以展示惰性评估语言的关键操作概念。希望你喜欢！

下一次：[在 Haskell 堆上的评估](http://blog.ezyang.com/2011/04/evaluation-on-the-haskell-heap/)

> *技术说明。* 从技术上讲，这个系列应该叫做“GHC 堆”。然而，我会尽量避免尽可能多的 GHC 专有名词，简单地提供一个关于任何一种惰性语言运算推理的隐喻。最初，这个系列的标题是“Bomberman 教你懒惰求值”，但是虽然我保留了用于表示延迟计算错误或不终止的 thunk 的炸弹隐喻，我更喜欢礼物隐喻：它特别捕捉到惰性的几个关键方面：它捕捉到了已评估/未评估的区别，以及一旦礼物被打开，就对所有人都打开了。术语“装箱”的使用有点暗示：确实，GHC 中的装箱值或*提升*值正是那些可能不终止的值，而非装箱值则更类似于 C 堆中所见的内容。然而，像 Java 这样的语言也使用“装箱”一词来指代看起来像对象的基本值。为了清晰起见，我们从现在开始不会再使用“装箱”一词（实际上，我们不会提及非装箱类型）。

本作品根据[知识共享署名-相同方式共享 3.0 未本地化许可证](http://creativecommons.org/licenses/by-sa/3.0/)许可发布。
