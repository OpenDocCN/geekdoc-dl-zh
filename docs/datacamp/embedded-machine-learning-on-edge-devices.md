# 边缘设备上的嵌入式机器学习

> 原文：<https://web.archive.org/web/20221129052847/https://www.datacamp.com/blog/embedded-machine-learning-on-edge-devices>

Daniel Situnayake 是 TinyML 的创始工程师，也是 Edge Impulse 的机器学习主管，Edge Impulse 是一个领先的嵌入式机器学习开发平台，全球超过 3000 家企业在 85000 多个 ML 项目中使用。Dan 拥有超过 10 年的软件工程师经验，包括 Google(他曾在 TensorFlow Lite 上工作)和 Loopt 等公司，并与人合作创建了美国第一家昆虫养殖技术公司 Tiny Farms。他写了《TinyML》这本书，还有即将出版的《边缘的 AI》。

Richie 帮助组织从模糊的“嘿，我们应该更好地使用数据”转变为现实的计划，成为成功的数据驱动型组织。在数据科学被称为数据科学之前，他就是一名数据科学家，已经写了几本书，并创建了许多关于该主题的数据营课程。

里奇·科顿:大家好。你可以从口音上听出来，我不是阿黛尔。我是里奇，数据营的数据传道者。本周，我将代替阿黛尔，不久我将开始共同主持数据框播客。我在数据科学和数据科学教育领域工作了近二十年。

我看着这个领域从一个小众的书呆子变成一个主流的书呆子。我职业生涯的大部分时间都在为生物学家、化学家和商业人士提供数据科学支持。我的经验是，即使是才华横溢的人有时也会因为不得不分析数据而感到恐惧。因此，我关心的是在接下来的剧集中让数据看起来不那么可怕，并重温传统的数据框架主题，即帮助组织成为数据驱动型组织。我也想给你们一些灵感，告诉你们使用数据的乐趣和可能性。

一旦你克服了恐惧，就会有很多乐趣。今天，我们将讨论低功耗设备上的机器学习，如骨骼和物联网传感器。所以这是一个迷人的新兴领域，我非常期待从丹尼尔·斯图纳亚克那里找到答案。Dan 是 edge impulse 机器学习的负责人，他是《微小的 ML》一书和即将出版的《边缘的人工智能》的作者。

他之前在谷歌工作于 TensorFlow light。所以这一切都是在说他是这个领域真正的专家。嗨，丹；谢谢你今天加入我们。我们将讨论边缘设备上的机器学习，这个术语对我来说相对陌生。所以也许...查看更多

s for a bit of context, you could just start talking to us about, well, what is an edge device?

丹尼尔·斯图纳亚克:是的，问得好，里奇。我很高兴今天能来到这里。所以边缘设备指的是位于网络边缘的计算机。所以这有点道理。如果你认为互联网是一个庞大的相互连接的设备的集合，但是它有一个边缘，那里有一些设备在某种程度上连接到一个更大的网络。

然后，在另一边，他们通过传感器和其他种类的硬件连接到现实世界。例如，一个典型的边缘设备可能是一个连接互联网的摄像头，或者是一个可以戴在手腕上的个人健身穿戴设备，它可以记录你的锻炼情况，并将有关数据上传到云。

边缘设备有大量不同的应用，从消费电子产品到工业系统，监控工业加工厂的各种设备，甚至最终的边缘设备是航天器。火星漫游者在火星上行驶，收集数据，上传数据，并将其发送回地球。这些是最先进的设备。

## 边缘设备上的机器学习

里奇·科顿:尽管如此，这还是令人印象深刻。它的应用范围如此广泛，但你能告诉我为什么你必须在边缘设备上进行机器学习吗？所以我认为，如果我在做机器学习，标准的事情是我会在我的笔记本电脑上做一些事情。因此，这将是处理模型，或者也许我正在云中工作。

所以某个地方会有某个服务器在处理事情。为什么你想在一个没有多少动力的设备上进行机器学习呢？

丹尼尔·斯图纳亚克:如果你考虑传感器数据和真实世界的数据，我们会进行排序。我有这样的想法，当我们作为数据科学家处理数据时，我们处理的是已经收集的数据集。我们大部分时间都在处理由我们的大型后端系统积累的数据集，以及基本上已经在我们的基础架构中生成数据的系统。但是如果我们收集传感器数据，那么我们收集的是真实世界的数据。实际上，现实世界有着几乎无限量的数据，这是一个瓶颈。这只是无穷无尽的新信息来源。想象一下，你有一个，一个收集温度和压力以及其他各种与气候或天气相关的东西的设备。

它就像一个无限的数据流，但它可能没有一个很好的连接来将数据发送到另一个可以分析它的系统。因此，通常情况下，边缘设备，因为它们位于网络的边缘，可能会受到不可靠的互联网连接或低带宽的影响，或者可能需要在受限的能源体制下运行。因此，他们使用电池或类似的东西，或者太阳能，他们无法承受一直通过网络通信消耗大量能源。如果你想想你的手机，除了手机屏幕之外，使用电池最多的东西是。用无线电广播信息。

因此，如果您的设备在某种程度上受到限制，无法以您接收数据的速度发送回所有数据，那么将一些智能放在设备上是有意义的，而不是依赖云服务来运行智能。

## 边缘计算背后的灵感

里奇·科顿:是的，我可以。看看火星漫游者是如何做到的，你可能不希望将所有数据从火星穿越太空发送到地球上的某个地方，然后试图获得所有结果并将其发送回来。所以感觉是一个稍微新奇的领域。我很好奇你是怎么想到边缘的。

丹尼尔·斯图纳亚克:是的，所以更广泛地说，edge ML 和 edge AI，也就是在边缘设备上进行各种人工智能的想法只存在了相对较短的时间。本质上来说。传播它并允许它发展的事实是，这些边缘设备已经变得足够强大，它们能够运行一些这些繁重的算法，如设备上的深度学习模型。但是，我参与这个是因为我在谷歌的 TensorFlow 团队工作，TensorFlow，你可能知道，是谷歌的大型深度学习框架。TensorFlow 有一部分叫做 TensorFlow light，它基本上是围绕着将模型向下部署到手机而设计的，因为手机是边缘设备，对吗？

它们是网络边缘的小型便携式电脑，上面有很多传感器。谷歌的一些人意识到，如果能够在手机上运行模型，做各种各样很酷的事情，那将会非常酷。然后，下一个合乎逻辑的步骤是思考，好吧，什么样的设备比手机更小，更前卫，更有可能，更省电。

有可能在这些基础上运行深度学习模型吗？我很幸运地在谷歌工作，当时一个叫皮特·沃顿的人成立了一个新团队，开始建设和研究。我基本上是幸运地在这个令人敬畏的新技术发布的时候出现了。

我意识到这是我在科技行业遇到的最令人兴奋的事情。到目前为止，我已经将我对嵌入式软件工程和边缘设备的迷恋与我对数据科学和机器的迷恋结合起来了。

里奇·科顿:太令人兴奋了。所以你一直在做的工作，像张量流之类的，和普通的 ML 有什么不同？它是如何被约束的或者是什么使它变得困难？

丹尼尔·斯图纳亚克:这真的很有趣，因为当你处理这种类型的实时传感器数据时，这本身就是一种与你所做的工作来源非常不同的范式。在数据集上，更多的是表格。举个例子，我们都非常熟悉表格数据的特征工程。

所以，也许我们正在看着分析一些事情的商业表现，或者一些关于我们世界正在发生的某种现象的政府数据。我们从这些数据中识别有用特征的典型工作流程使用了一组工具，它们占据了一个范例。但是当你想到实时传感器数据时。

因此，这基本上就像是以非常高的频率出现的信息的小样本，本质上很难将原始信息输入到机器学习模型中。有一整个额外的领域。这种技术已经存在了很长时间，称为数字信号处理，它基于这样一种想法，即有一些算法可以理解这种传感器数据的实时流，并对它们进行提取，从而获得最有趣的可见成分。

所以。不管你想在下游做什么？没有被这些原始数据淹没。这些算法看起来和你用表格数据做的任何事情都非常不同。例如，对于音频数据，基本上在某一频率下，你会得到一长串频率很高的数字，这代表了几乎正在发生的压力量。麦克风振膜在任意给定点的弯曲量。为了将它转化为深度学习模型可以理解的东西，最好的方法之一是通过建立一个称为频谱图的东西，它基本上是信号或频域中一系列值的表示。

所以与其拥有。这些振幅值的单个列，最终得到一个 2d 矩阵，它在 X 轴上表示时间，在 Y 轴上表示频率，这些值被划分到各个桶中。这基本上就像一幅图像。这就是你所吃的。深度学习模型。

所以你可以用一个卷积神经网络来理解它。因此，这一切都是为了将信号从原始形式转换为更高维度但频率更低的形式，这通常不太方便，但更便于使用这些机器学习。

里奇·科顿:这很有意思。所以我对学习傅立叶变换和小波有着遥远的记忆。还有大学做信号处理之类的东西。所以在我心目中并不新鲜。我认为这是我以前没有在数据科学或机器学习环境中使用过的东西。

所以那种工程类的东西总是非常独立的。所以听到这种音频工程和机器学习是如何结合在一起的是很有趣的。

丹尼尔·斯图纳亚克:我喜欢它的一点是，嵌入式工程和信号处理这个巨大的领域已经存在了相当长的时间。和绝对的人。这方面的专家令人难以置信。我们发现，来自机器学习、深度学习和数据科学的东西与这种信号处理专业知识之间有着惊人的融合。

当你把双方的人聚集在一起时，你就能想出非常惊人的方法来解释信号和训练模型。真的很刺激。

## 设备变量对机器学习的影响

里奇·科顿:当你有一个非常低功率的设备，也许你没有一个很好的互联网连接，你是有限的。电池寿命之类的。这对机器学习方面有什么影响？那么是不是一定要选择不同的模型，训练的东西不一样，或者对实际模型本身有什么影响？

丹尼尔·斯图纳亚克:首先，我要指出的一点是，当我们谈论嵌入式设备上的机器学习时，绝大多数时候我们谈论的是推理，而不一定是训练。因此，没有什么可以阻止你在这些边缘设备上训练模型。在某些情况下，这种情况确实会发生，但边缘设备的最大限制之一是您可以使用的内存有限。

所以，当我们谈论用监督的方法训练模型时，那是不可行的。如果你没有。足够的空间来存储数据。也许你只有几十千字节，这显然不足以存储大量的数据集。因此，如果你在做某种无人监管的方法，或者你有某种有趣的方法，你如何在设备上微调模型，有时可以工作，但很多时候我们只是谈论运行推理。

当我们在的时候，我们在讨论运行推理。实际上有三个主要的限制。第一个限制是。与此相关的是设备的性能。因为如果你想让一个设备靠电池运行，比如，你不会有两千兆赫的处理器、多核 CPU 或 GPU 在里面运行。

有非常强大的边缘设备，但通常你会看到更多的时钟速度比你将在限制。运行机器学习模型的服务器端基础设施。所以问题是运行模型非常慢。这意味着你会偏向于训练较小的模型。

就像一个更小的模型将能够在一个设备上运行得更快，使用更少的能源，并符合边缘的这些限制。另外两件事是只读存储器和。区别在于，只读存储器是用来存储模型的重量，以及在你的边缘设备上运行的程序。

所以很明显总有一个范围。在计算硬件中，但在最小的一端，你可能只有几十或几百千字节来存储你的模型的重量。因此，如果我们考虑典型的视觉深度学习模型，即使是像为在手机上运行而设计的移动网络模型这样的东西也将太大，无法在这些最小的边缘设备上运行。

所以你需要思考我们如何让这些模型变小，然后。RAM 零件。工作记忆同样重要，因为你需要有人在你的信号到来时存储它，你需要存储，例如，在你工作时，你的模型、层的中间激活。

如果你没有足够的内存，你就不能这样做。这是三个最重要的约束条件。迫使您考虑更小的模型和模型，它们的设计在 RAM 使用方面是高效的。它还鼓励您在前期尽可能多地进行信号处理，因为在通过信号处理提取特征和使用一定量的计算之间往往存在权衡。

例如，向你的深度学习模型扔东西，让它找出特征提取第二部分。对于任何给定的设备，都会有一个特定数据集的理想设置点，在这两个部分之间有一个最有效的完美权衡，但这需要根据设备和数据集来确定。

所以这就带来了额外的限制。但是，当您在大型、强大的开发人员工作站或后端服务器上考虑数据科学时，您不必考虑。对我来说，这才是真正令人兴奋的地方。有约束总是好的，因为它迫使你有创造力，想出做事情的新方法。

## RAM 与可预测性之间的权衡

里奇·科顿:太不可思议了。所以我感觉有某种权衡，你可能会牺牲一点点预测能力，因为你在使用。生硬的模型，但这是必要的，能够运行它，因为你没有计算能力或内存可用。那是正确的吗？

丹尼尔·斯图纳亚克:对。我是说，这可能是真的。如果我们考虑更大、更高维度的数据，比如图像，通常如果你压缩一个模型来得到它，在嵌入式设备上运行，首先，可能只是训练一个更小的模型，比如提出一个重量更轻的架构，然后训练它。

还有。这是一种方式，很明显，权重越小，模型的代表性就越小。因此，你可能会得到性能。这不如你在大模型上做的好。我们拥有的第二个东西是模型压缩的想法，你可以选择一个经过训练的模型。

以一种典型的方式，好像它会在任何设备上运行。然后你可以做一些事情来减少它。Precision 可能会降低其准确性，但会使其变得更小。其中之一叫做量子化。所以量子化，你可能在中遇到过，也在后端世界中。

这是一种通过降低典型深度学习模型中权重的精度来使模型变得更小的方法。比如说。权重通常以浮点 32 格式训练。我们得到了这些 32 位浮点数。它们很有表现力。它们可以代表很大范围的值，但是要让它们在嵌入式设备上运行，如果您。

减少可用于存储每个权重的位数。所以你把它减少到八位。因此，您现在将组成模型的数字存储为八位数字。那是四倍小的模型。因此，如果你能做到这一点，并且不把模型的准确性搞砸太多，那就太好了。

实际上有非常聪明的方法。真的损失几乎没有任何精度，但减少模型四倍或八倍，甚至最小的精度模型实际上。b 神经网络，BNS，具有一位权重。因此，从字面上看，模型的权重是二进制的，你需要一些特殊的机制来训练它们，但是它们，它们可以很好地工作。

因此，所有这些都伴随着权衡取舍，而这就是管理权衡取舍并保持应用程序所需的性能。

## Edge ML 入门

里奇·科顿:我想很多听众会想知道，我该如何参与其中？听起来很刺激。那么如何开始呢？

丹尼尔·斯图纳亚克:这个话题有很多不同的角度。有些人从嵌入式工程的角度来看这个问题。在使用微控制器或嵌入式 Linux 板(例如 raspberry PI)之前，我曾从事嵌入式工程工作，但他们遇到了一个难题，他们希望了解世界，并了解他们正在设备上获取的数据。

但是你只能用手动编码算法和基本的信号处理做这么多。所以他们想在设备中嵌入更多的智能。还有一些人来自另一端，他们可能有数据科学的背景。机器学习。他们想知道，比如，我怎样才能把我们能够封装在模型中的一些智能放到这些微型设备上，这样它就可以在以前没有的地方使用。

所以你的旅程可能会有一点点不同，这取决于你是从哪边来的。因为如果你是数据科学家，你会对这些更加熟悉。数据科学工具和不太熟悉的嵌入式方面。如果你是一名嵌入式工程师，反之亦然。

让我们假设你是一名数据科学家，你对开始做这种事情感到兴奋。我认为这是个好的开始。你不一定要有嵌入式设备才能开始思考如何训练更小的模型。会很有趣。开始意识到模型的大小和它们消耗的资源量之间的关系。

开始尝试进入那种心态，对事物进行修补，并开始学习，比如，哦，如果你改变它，对性能会有什么影响。你可以开始学习模型压缩和量化。就这样开始你的旅程。最容易开始的地方可能是较大的边缘设备，如覆盆子馅饼，因为你可以在那里运行 Python，这样你就可以训练 TensorFlow 模型，然后直接在设备上运行它。如果你使用微控制器，就没有那么多额外的工作要做。这些事情就像。生活在家用小器具中的微小过程，真的是超级普遍地存在于我们的世界和我们的建筑环境中。用它们编程的工作流程要复杂得多。

所以他们通常要求你写。用 C 或 C plus 编写代码，然后使用一组特定于设备的编译工具，这些工具允许您编译代码以在该特定设备上运行。一家名为 Arno 的公司在该领域制造了一套非常容易使用的设备。

微控制器被设计为易于编程和易于使用，它们可以成为嵌入式机器学习开发的良好起点，但它很容易迷失，因为该领域有太多东西在进行。所以我建议我有点偏见，因为我在一家名为。

边缘冲动。我们有这种令人惊叹的端到端工具套件，允许您与设备集成，收集数据集，试验信号处理和机器学习模型的组合，然后部署到设备上。还有。我建议亲自前往我们的文档，只需搜索 edge impulse，或前往 edge impulse.com 挖掘。

我们有大量的教程，旨在使它变得容易，开始学习所有这些不同的运动部件如何相互联系，以及如何训练一个模型。还有。

里奇·科顿:有没有一种标准的简易优先项目？比如 ML 的 hello world 是什么意思？

丹尼尔·斯图纳亚克:所以我和来自 TensorFlow 的 Pete Warden 一起写了一本书，就像几年前的 micro team。我们为小马丁公司设计的 hello world 项目是。基本上，你能训练一个微小的模型来做一些任意的事情吗？所以对我们来说，这是给定一个符号的 X 值，预测 Y 值，波函数。

所以。训练尽可能简单的模型。然后将它转换成一种可以在嵌入式设备上运行的形式，然后将其部署到嵌入式设备上，这个过程的所有部分都非常困难。训练一个有效的模型是困难的。收集一个好的数据集是困难的。信号处理很困难。部署设备，只需将非常简单的东西部署到嵌入式设备上，并熟悉那里的整个流程。那是一种，如果你从零开始处理事情，自己做每件事，但我建议去像 edge impulse 这样的平台，按照步骤做一些事情，训练一个在简单时间序列上运行的模型。

例如，许多微控制器开发板都会内置加速度计。一件很好的事情是训练一个模型。根据加速度计的数据识别不同类型的活动。加速度计基本上返回三个值的时间序列。这三个值是 X 轴到 Y 轴和 Z 轴的加速度。

所以你得到了三维空间中运动的概念，你可以训练一个模型来识别不同类型的活动。比如慢跑和做俯卧撑之类的。你收集一些数据，为每一个动作设置数据，然后进行训练，使用一些信号处理来提取相关信息，训练一个小模型，然后将其部署到设备上。

然后你可以把这个东西戴在手臂上，它会对你的活动进行分类。这真的很酷因为。这就是人们健身时佩戴的智能手表的工作原理，它可以理解你是在跑步还是在游泳或类似的事情。而你，你可以开始看到这一切是如何首尾相连的。

如果您没有任何嵌入式经验，甚至很难从设备上获取初始数据。这就是为什么这种端到端框架端到端平台如此强大的原因，因为它们提供了从那里获取数据所需的所有软件。

## 常见错误

里奇·科顿:制作自己的健身手表听起来确实是一个非常酷的项目，但我可以看到有很多不同的步骤，你需要了解一些关于很多方面的知识

来做那个。所以也许可以谈谈当人们试图这样做时，什么是好主意。什么是坏主意？那么，也许你能告诉我一些人们在尝试做这类事情时会犯的常见错误？

丹尼尔·斯图纳亚克:我经常遇到的一件事是，测试数据、训练数据和真实世界数据之间有很大的差异。如果我们使用传感器数据。基于一个数据库中的东西训练一些东西，这个数据库来自一个云软件。所以表格数据是基于，比如，我不知道，用户在社交网络中的行为或类似的东西，这些数据以同样的方式被测量，在数据收集和生产过程中以同样的方式被收集。只是我们拍了某一时刻的快照。我们现在已经获得了大量的训练和测试数据。在那之后，所有真实世界的数据都以完全相同的方式生成。但有了嵌入式机器学习，你在收集数据时会面临更多挑战。

想象一下我们要设计一个新产品。我们正在设计一种新型智能手表。这应该会有帮助。我不知道，登山者和，给他们一些关于他们攀登的反馈。所以这个设备实际上还不存在。在我们造出那个装置之前，我们需要。设计和训练这个机器学习系统，它可以给攀岩者反馈，但是因为我们还没有造出任何设备，我们必须在没有我们真实世界的真实设备的情况下收集一些数据。

所以。首先，我们必须开发一个仅从一些传感器收集数据的原型。也许它的大小和形状与真实的东西大致相同，让一些人戴上那个设备，进行一些攀爬，并以某种方式标记数据。也许就像，哦，这是一次艰难的攀登，而不是一次轻松的攀登。

收集整个数据集。一旦我们完成了，我们可以训练一个模型，我们可以测试它，我们可以看到，好的，这个模型可以准确地分类，这是一个容易的攀登还是一个困难的攀登，但问题是。当我们进一步完成产品开发流程，完成硬件设计后，也许手表的形状和尺寸会略有不同。

也许它上面有一个稍微不同的传感器。这就像它仍然是一个加速度计，但它是一个不同型号的加速度计，因为那个更便宜，我们需要用更便宜的来达到我们的目标，即器件的价格。所以。当它被部署到现实世界中时，设备会略有不同，这意味着输出的数据会略有不同。

这意味着我们的模型不一定能很好地工作。真正的挑战是，所有的数据都被困在网络的边缘，而设备是解释这些数据的工具。我们不一定有办法检查它是否运行良好。没错。我们不能仅仅比较现实世界的表现和预测的表现，因为我们没有这些数据，也没有办法给它们贴上标签。

所以有一个很大的风险，你可能最终训练出一个看起来非常好的模型。在投入生产之前。然后，当它投入生产并部署到真实设备上时，它就不能很好地工作了。这是所有数据科学中的一个风险，但它在这里被放大了，因为我们在开发和生产之间的反馈循环更少。所以这可能是我们不得不解决的最可怕的事情。

## 可能的解决方案

里奇·科顿:哦，哇。呃。是的，我肯定那会是个问题。那么公司如何处理这类事情呢？

丹尼尔·斯图纳亚克:对。我的意思是，这很棘手，这是一个正在进行的事情，我们正在发展系统和工作流程来处理。但最明显的事情是尽可能保持生产和开发之间的相似性，确保使用相同的传感器，并确保以相同的方式收集数据，但显然这并不总是可能的。因此，你必须考虑如何建立一些正在进行的过程，以继续测试并确保系统在现实世界变化时仍然工作，因为显然还有漂移的概念，现实世界总是在变化，而你的模型代表了一个冻结的时刻。

这一点在。这个领域，因为我们直接处理从传感器获取的真实世界数据。因此，你可以做的一件事是定期派人去获取更多的数据，并据此测试你的模型。所以这可能是一个有用的信号。所以不如直接。

看看现实世界中发生了什么，但它会给你一个正在发生的事情的周期性快照，你可以看到，好的，有了我收集的这些新数据，这个模型仍然在工作。你可以做的另一件事是查看你的模型的输出。所以推测起来，这些设备或智能手表是人们为了攀岩而佩戴的。

他们会把数据报告给某个系统。因此，如果他们确定攀登是有挑战性的，这将被记录在用户的账户中的某个地方，以便他们以后可以看到它。因此，你可以做的一件事是观察模型输出随时间的分布，因为即使你不能保存所有的原始传感器数据，你也有可能保存模型的输出。如果输出的分布。随着时间的推移发生了很大的变化，或者它们与您最初捕获的测试数据非常不同。例如，这可能是一个信号，表明已经发生了一些漂移，或者现实世界正在占据与初始数据集不同的分布。因此，这可能意味着你需要收集更多的数据，做更多的评估。

里奇·科顿:回到攀岩手表的例子。这听起来可能只是一种情况，你让你的攀登回来，让他们爬上他们在使用生产版本的手表而不是原型之前的同一条路线。

丹尼尔·斯图纳亚克:没错。是啊。也许你犯了一个错误，最初从专业攀岩者那里收集数据，然后你发现买你手表的人也在。大众只是业余爱好者。所以也许你需要找一些业余爱好者来，从他们那里收集数据。这能让你更好地了解现实世界中的情况。所以所有这些东西都是你在实验设计中必须小心的。

## 使用 edge 的最佳实践

里奇·科顿:是的，业余选手从岩壁上掉了下来。所以把这个翻过来。使用 edge 有什么特别的最佳实践吗？

丹尼尔·斯图纳亚克:这是一个非常非常大的领域。所以有很多不同的地方。但我认为对我来说最重要的事情是试图弄清楚，因为这是一个如此大的领域。从数据集到部署在设备上的模型的工作流程中有如此多的步骤，在开始时对所有不同的移动部分有一个良好的理解是非常重要的。

因此，了解什么是我们将要部署到这么多设备上的硬件，就像搞清楚。基于您将部署到的硬件的一个很好的折衷方案。那么这是提前知道的吗？我们可以根据我们最终训练的模型来选择硬件吗？或者更确切地说，我们已经有了一个已经存在的设备，我们需要在它的备用内存中安装这个模型。

所以在开始的时候确定下来是非常非常重要的，这将会影响到整个项目。我认为真正重要的第二件事是理解我们在这里想要实现什么？我们能做的最起码的事情是什么，才能产生有用的产品，因为有时以这个基本目标为目标是好的。改进，而不是说，我们想做所有这些不同的事情，做这种会唱歌，会跳舞，有魔力的人工智能产品，然后尝试和失败。

最好选择一个简单、直接的东西，它将对您的客户有帮助，然后交付给他们，然后从那里开始工作，逐渐添加更多的功能和改进东西，但尝试从简单的东西开始，因为这真的很有挑战性。

## 边缘 ML 的更多示例

Richie Cotton:我想多谈一些使用案例。所以你提到了火星探测器的高科技，然后有了这个登山手表的消费产品创意。然后你谈到了传感器和其他东西。你能给我举几个例子来说明这种方法的应用吗？

丹尼尔·斯图纳亚克:我们的客户遍布你能想象到的任何地方。它涵盖了从消费产品的一切。使用一点智能在家里做一些更智能的事情，一直到了解工厂正在发生什么的工业系统，也许在产品制造出来后分析产品的质量。

所以你可以理解。你的制造过程有瑕疵。医疗保健是一个有趣的领域，解释生物信号，使用机器学习来了解某人的身体功能或疾病的发展。农业真的很有趣，比如了解植物如何生长，动物健康如何，或者了解气候。

所以任何和雷克斯有关联的地方。真实的世界和正在发生的有形的事情，我们需要了解更多。你能想到的任何领域都有嵌入式机器学习的应用。

里奇·科顿:是啊，太神奇了。呃，机器学习正在入侵我们生活的方方面面。所以是的，这很有趣。

丹尼尔·斯图纳亚克:这是我真正感到兴奋的事情，因为直到现在，机器学习一直存在于一个受限制的领域。一组适合它的地方。对吗？我们已经让这些巨大的模型在强大的计算机上运行，但是现在我们能够。将机器学习推向越来越小的设备，这样它就可以更整洁地融入我们生活的小角落。

它使事情民主化了一点，而不是需要这些运行在云中的一刀切的巨型模型。在一些大型科技公司的数据中心，我们可以让工作人员训练小的微型模型。在世界的小角落，无论是在某个利基领域，还是在有特殊问题和挑战的地方，我们都可以用机器学习来解决。

从这些较小的模型中获得良好的性能，而不是试图创建这些庞大的模型来做所有的事情，这要可行得多。

里奇·科顿:在微小的机器上有许多微小的东西。所以这很酷。这在很大程度上是一个新兴领域，我感觉已经取得了很大的进步，但目前可能还存在一些限制。因此，也许你可以谈一谈症结所在。特别是对于微小的 ML，我想你会有更强的约束。

丹尼尔·斯图纳亚克:最大的问题之一就是工具。如果你在嵌入式领域工作。软件或硬件设计的机会是，举例来说，如果你在农业领域有所建树，你的团队将会在农业领域拥有丰富的经验和专业知识。你可以用它来设计和制造一个在这个领域有效的产品。因此，如果你在这个领域工作，你已经是一个深入的专家了。域。你是嵌入式工程领域的资深专家。你很可能不具备成为深度机器学习专家的带宽。如果你想把机器学习作为一个项目的一部分，首先，这是一个巨大的，非常困难的学习曲线，你必须成为一名 ML 专家，然后将这些知识应用到你试图解决的问题中。

最大的问题。最大的挑战是，我们如何让嵌入式工程领域的专家以及他们工作的任何领域的专家能够使用机器学习，而不必成为机器学习专家，也不必花数年时间研究该领域，并了解数据科学的来龙去脉。这就是这个领域有巨大机会的地方。授权给没有机器学习和数据科学背景的人，显然，构建这些工具需要数据科学和机器学习专业知识。因此，在调整和适应这些工具链方面，存在着巨大的机遇和挑战，以便在一个非常重要的小领域中成为专家的人可以利用这些工具链。

里奇·科顿:那个农业的例子真的引起了我的共鸣。所以我的岳父是一个牧羊人，当他有几十年的养殖经验时。我想他这辈子都没碰过电脑。所以越来越。他认为机器学习将是一个非常没有去的领域，但试图让他所有的领域知识进入某种模型将是一个非常有趣的挑战。所以我知道这是一件多么困难的事情。

丹尼尔·斯图纳亚克:是的，当然。这甚至是我们直接看到人们使用边缘人工智能模型来识别何时变得纯粹。在农场的不同地方，或者在马路上行走，或者在动物的脖子上戴上设备，记录它们的生物信号和活动，这样你就可以了解它们的健康状况。

## 最重要的挑战

里奇·科顿:目前事情进展如何？正在应对的最重要的挑战是什么？

丹尼尔·斯图纳亚克:所以现在，我认为一些最大的。最重要的工作是在这个领域向人们开放，让人们理解机器学习的工作流程，而不是成为机器学习专家。基本上，构建工具来理解传感器数据，能够查看传感器数据的数据集有多好，了解质量，并向人们提供反馈，比如，哦，你应该收集更多这类事情的例子。

最大的困难之一是收集标签数据可能非常困难。如果你考虑传感器数据。从本质上来说，它就像一个巨大的时间序列，非常难以理解。你不一定要看一个所有这些行的表，比如每秒一千行。

某个任意值从传感器中读取，并作为一个人来理解它。因此，我们需要想出一些技术，让人们能够获取一个大数据集，比如数百小时的未标记的高频传感器数据，并对其进行标记，然后能够将其用于训练，或者能够进行某种不依赖于标签的训练。

所以那是，那真的是一件大事。另一件大事是理解。模型在这类数据上的表现，并解释模型如何表现，它们在哪里表现良好，在哪里表现不佳，这类大数据集很难解释数据。在这一领域，我们发现的一件令人惊讶的事情是，内存和延迟等设备限制并不像您想象的那样是一个大障碍。

事实证明，如果你使用一些智能信号处理，并训练一个小模型，你通常可以用非常少的硬件做很多事情。我们习惯于把事情开到最大，用最大的型号，你可以不用过度适应，所有这类事情。但是如果你想在这些设备上安装模型，你可以用你仅有的一点空间做很多事情。

这个领域有很多人在调查。压缩以及如何将越来越大的模型安装到越来越小的设备上。但是对我们来说，很少会有客户需要一个太大而无法安装在嵌入式设备上的模型。更多的情况是，他们没有足够好的数据集来训练模型。

里奇·科顿:这似乎是一件很平常的事。学习的难点是获得运行模型的良好数据，而不是实际的建模部分本身。

丹尼尔·斯图纳亚克:当然。是啊。尤其是传感器数据，你可以看到自然语言这样的东西。图像数据。有大量的数据集是从互联网上搜集来的，人们过去可以用这些数据集来创建新类型的模型并对其进行基准测试。但是有了传感器数据，就没有那么多了。

以及能接触到传感器数据的人。对分享它非常谨慎，因为这对他们来说代表着重要的知识产权。如果你有一家生产某种小工具的公司，你的所有设备上都有各种传感器，用来监控。这种制造正在进行，这代表着贵公司可以用来潜在地改进其流程的宝贵数据。

你不一定希望你的竞争对手得到它。这是一个挑战，就像数据集的可用性以及隐私和数据共享的问题。

## Edge ML 的未来

里奇·科顿:我知道这是个什么问题。也许如果有听众拥有可以公开分享的传感器数据集，那么我并不鼓励你这么做。如果你能做到。导致任何隐私问题或知识产权问题。所以这整件事看起来像是到了一个可能会大受欢迎的程度。

感觉就像工具在一起，技术在一起，一些过程也在一起。那么你认为未来几年什么会推动 Edge ML 的采用呢？

丹尼尔·斯图纳亚克:对。我们认为这是一种巨大的未开发的潜力。根据传感器数据，我们得到了这些，这些巨大的。现实世界中存在着难以置信的有价值的数据池，现在它们被完全丢弃了。大多数连接的数据都是由 IOT 设备收集的。

例如，并不真正用于任何事情。我们拥有所有这些技术。传感器和嵌入式设备可以收集大量关于现实世界情况的数据，但由于这些带宽和延迟的限制，我们基本上还没有利用它。那么是什么在驱动它呢？

在整个行业、消费设备和任何地方，这些数据都有巨大的未开发价值。突然间，我们有了工具来利用它，制造更好的产品，更智能地做事，更高效地在生产线上创造更高质量的产品，例如，或者监测我们的自然世界，以了解生态和环境如何变化，以及气候如何变化。

因此，非常有必要解释所有这些数据，以便我们能够使用它们。这就是让我们能够做到的技术。

## 面向初学者的 Edge ML

里奇·科顿:激动人心的时刻。所以，对于那些想尝试一下，但不一定想单干的人来说。有什么好的社区适合想入门的人吗？

丹尼尔·斯图纳亚克:有一个非常棒的组织，叫做小马丁·路德·金基金会，这个组织在这个领域很早就存在了，他们组织了一系列的活动。世界各地的聚会团体。有几十个这样的地方，你可以和其他对这个领域感兴趣的人一起去当地聚会。所以如果你去小小的 ml.org，你可以找到一些链接。

而小小的 ML 基金会每年也办一个会或者减几个会。在世界的不同地方。我们也做这些每周或每两周一次的讲座，你可以观看现场直播。他们也在 YouTube 等网站上。周围也有一些论坛。所以 edge impulse 论坛是一个非常好的去处。

如果你去 impulse.com 网站 edge，那里有一个链接，很多人都在讨论嵌入式机器学习。你可以做的另一件好事是有几门课程可供选择，所以有一门课程误差课程。一些人在 edge impulse 把这些放在一起，这给了你如何开始使用这项技术的介绍。

还有一门哈佛 edX 课程。更深入的理论。所以，如果你对幕后的部分感到兴奋，更像是数学的东西，哈佛的课程是一个很好的去处。如果你对应用程序感兴趣，并想知道我如何尽快开始用这项技术构建东西，那么 Coursera 课程真的很棒。

Richie Cotton:我可能应该补充一下，对于任何对分析传感器数据感兴趣的人，我们确实有一个 DataCamp 课程，以及分析物联网和 Python 中的数据。

丹尼尔·斯图纳亚克:听起来是个不错的开始。

里奇·科顿:这是一个非常温和的介绍，有很多时间序列分析和一点机器学习。所以在我们结束之前，你对想自己尝试一下的人有什么最后的建议吗？

## 行动呼吁

丹尼尔·斯图纳亚克:对。所以不要害怕。好像这是一个很大的领域。有很多移动的部分，非常复杂，但绝对有可能。如果使用正确的工具，专注于您关心的部分，忽略其余的复杂性。所以我不会建议大多数人从零开始，试图同时学习所有这些小零件和所有运动部件。

如果你已经对数据科学和机器感兴趣。然后找到一个平台，为您实现嵌入式方面的自动化。所以很容易收藏。一些数据集可以轻松部署到设备上，然后您可以专注于机器学习。否则，如果你是一名嵌入式工程师，你对做这一部分感到兴奋，但不一定想花几年时间成为数据科学专家，同样的平台将帮助你。

专注于构建您想要的产品的嵌入式部分，而无需重返学校。所以绝对不要害怕使用工具来帮助你，也不要试图从头开始一切，因为这非常困难。

里奇·库托:好的，非常感谢你回答所有的问题。很高兴你能上播客。非常感谢你，丹。

丹尼尔·斯图纳亚克:我也是。谢谢你，里奇。今天和你聊天很愉快。