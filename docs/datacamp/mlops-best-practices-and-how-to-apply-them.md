# MLOps 最佳实践以及如何应用它们

> 原文：<https://web.archive.org/web/20230101103007/https://www.datacamp.com/blog/mlops-best-practices-and-how-to-apply-them>

机器学习操作(MLOps)现在是许多数据领导者和从业者的核心关注点，在过去两年里兴趣显著增加。这种急速上升是由许多组织面临的重大挑战所驱动的；对机器学习和人工智能的投资并没有带来承诺的投资回报。

![Search interest in MLOps over time](img/cf643adf46ad8ad89b2a092efec6175c.png)

2019 年， [Venturebeat](https://web.archive.org/web/20220529051436/https://venturebeat.com/2019/07/19/why-do-87-of-data-science-projects-never-make-it-into-production/) 报告称，只有 13%的机器学习模型能够投入生产。虽然 [KDNuggets](https://web.archive.org/web/20220529051436/https://www.kdnuggets.com/2022/01/models-rarely-deployed-industrywide-failure-machine-learning-leadership.html) 最近的一项民意调查表明，2022 年将有所改善，但 35%的受访者仍然提到阻碍他们部署模型的技术障碍。

麦肯锡的《2021 年人工智能状况》报告显示，人工智能的采用率从 2020 年的 50%上升到了 56%。随着组织加大对机器学习系统和人才的投资，有效部署和提取模型价值的必要性变得比以往任何时候都更加明显。这就是 MLOps 的用武之地。成功采用 MLOps 的组织看到了更好的[投资回报](https://web.archive.org/web/20220529051436/https://www.kainos.com/insights/whitepapers/fsi-whitepaper)。通过采用 MLOps，数据团队正在减少原型开发、开发和部署机器学习系统所需的时间。

MLOps 的目标是将技术与组织变革相结合，将软件工程概念应用于机器学习。通过将机器学习视为一门工程学科，它承诺了一条通往生产和生产中更长寿命模型的直截了当的道路。

本文将定义 MLOps，为什么它很重要，并提出定义当今成功 MLOps 实践的五个指导原则。

## 什么是 MLOps？

MLOps 的最佳定义是“一套工具、实践、技术和文化，确保机器学习系统的可靠和可扩展部署。”MLOps 借鉴了软件工程的最佳实践，如自动化和自动化测试、版本控制、敏捷原则的实施和数据管理，以减少技术债务。

技术债或代码债是一个来自软件工程本身的概念。它描述了由于快速开发而积累的“债务”,在快速开发中，诸如自动化、文档化和单元测试之类的过程在稍后的阶段被重构。简而言之，这是债务开发团队通过不采用当前的最佳实践而带入未来的。

机器学习系统可能会招致高水平的[技术债务](https://web.archive.org/web/20220529051436/https://proceedings.neurips.cc/paper/2015/file/86df7dcfd896fcaf2674f757a2463eba-Paper.pdf)，因为科学家产生的模型数据只是一个更大难题的一小部分——这个难题由基础设施、模型监控、特征存储和许多其他考虑因素组成。

![Real-world machine learning systems](img/2088ea4ab6864dd9af453ad29fad4ed0.png)

## 是什么让 MLOPs 独一无二

旨在减少技术债务的软件工程最佳实践通常被称为 DevOps。DevOps 将编写代码、版本控制和测试的开发活动与发布、部署和监控的 IT 操作结合起来。

DevOps 的两个核心原则是持续集成和持续交付(CI/CD)。

*   **持续集成(CI)** :新的代码变更被定期构建、测试，并合并到一个共享的存储库中。
*   **连续交付(CD)** :对应用程序所做的任何更改都会被自动测试并上传到一个存储库，在那里它们可以被部署到一个真实的环境中。

生产和扩展机器学习系统带来了额外的复杂性。软件工程主要是设计具有精确输入和输出的定义良好的解决方案。另一方面，机器学习系统[依赖于通过统计方法建模的真实世界数据](https://web.archive.org/web/20220529051436/https://www.oreilly.com/radar/mlops-and-devops-why-data-makes-it-different/)。这引入了需要考虑的更多因素，例如:

*   **数据**:机器学习接受高度复杂的输入数据。这些数据必须进行转换，以便机器学习模型可以产生有意义的预测。
*   **建模**:开发机器学习系统需要实验。为了有效地进行实验，跟踪每个实验的数据变化和参数是必不可少的。
*   **测试** : 除了单元测试之外，机器学习系统需要对数据和模型性能进行更复杂的测试，在单元测试中，应用程序的小的、可测试的部分被独立测试。例如，测试新的输入数据是否与训练数据共享相似的统计属性。
*   **模型漂移:** 机器学习模型性能总会随着时间衰减。导致这种情况的原因是双重的 。概念 Drif t 是我们试图预测结果变化的性质所在。一个很好的例子是在新冠肺炎停工期间，许多零售商经历了卫生纸等产品的意外飙升。根据标准数据训练的模型会如何处理这种情况？ 数据漂移 另一方面是指 自变量的性质因各种因素而发生变化，包括季节性、消费者行为的改变或新产品的发布。
*   **持续训练** : 机器学习模型必须重新训练，因为新的数据变得可以用来对抗模型漂移。
*   **管道管理** : 数据在输入模型之前必须经过各种转换步骤，并应在训练前后定期进行测试。管道将这些步骤结合起来进行有效的监控和维护。

## 成功 MLOps 的 5 个原则

采用 MLOps 并不像与新的 SaaS 供应商合作或构建新的云计算实例那样简单。它需要仔细的计划和团队与部门之间一致的方法。以下是成功实施 MLOps 的五项原则:

### 了解您的 MLOps 成熟度

领先的云提供商如[微软](https://web.archive.org/web/20220529051436/https://docs.microsoft.com/en-us/azure/architecture/example-scenario/mlops/mlops-maturity-model)和[谷歌](https://web.archive.org/web/20220529051436/https://cloud.google.com/architecture/mlops-continuous-delivery-and-automation-pipelines-in-machine-learning#whats_next)通过成熟度模型来看待 MLOps 的采用。这是因为 MLOps 需要组织变革和现代工作方法。这只会随着组织的系统和过程的成熟而发生。

成功采用 MLOps 需要对组织在其 MLOps 成熟度方面的进展进行诚实的评估。在可靠的成熟度等级评估之后，组织可以理解他们可以采用什么策略来提升成熟度等级。这涉及到流程变更，如将开发运维应用于部署或向团队添加新员工。

了解成熟度级别如何帮助组织确定 MLOps 计划的优先级也很重要。例如，特征存储是存放机器学习常用特征的单一数据仓库。功能存储对于数据相对成熟的组织很有帮助，在这些组织中，许多不同的数据团队需要使用一致的功能并减少重复工作。如果一个组织只有几个数据科学家，那么一个功能库可能不值得花时间。

通过使用 MLOps 的成熟度模型，组织允许团队、流程和他们的技术堆栈一起发展。它确保迭代可以发生，并且工具可以在实现之前进行测试。

### 在您的流程中应用自动化

自动化与成熟度模型的概念密切相关。先进而广泛的自动化有助于提高组织的 MLOps 成熟度。在没有 MLOps 的环境中，机器学习系统中的许多任务都是手动执行的。这些任务可以包括数据清理和转换、特征工程、分割训练、测试数据、编写模型训练代码等。通过手动执行这些步骤，数据科学家会引入更多的误差，从而浪费更多的时间进行实验。

自动化的一个很好的例子是持续再培训，数据团队可以为数据接收、验证、实验、特征工程、模型测试等建立管道。经常被视为机器学习自动化的早期步骤之一，持续再训练有助于避免模型漂移。

MLOps 中的管道与数据工程或 DevOps 中的管道没有任何不同。机器学习管道是一系列编排数据流入和流出机器学习模型的步骤。

为了说明管道的力量，我们可以想象一个例子，其中数据科学家已经手动提取了一些数据，但能够自动执行验证、数据准备、模型训练和评估过程。当模型被生产时，这个管道可以被重新使用来对新数据进行预测。

### 优先进行实验和跟踪

实验是机器学习生命周期的核心部分。数据科学家用数据集、特征、机器学习模型、相应的超参数等进行实验。实验时有许多“杠杆”可以利用。为了找到正确的组合，跟踪实验的每次迭代是必不可少的。

在传统的基于笔记本的实验中，数据科学家手动跟踪模型参数和细节。这可能导致流程不一致，并增加人为错误的可能性。手动执行也很耗时，并且是快速实验的一大障碍。

虽然 git 被广泛用于跟踪代码，但对科学家运行的不同实验数据进行版本控制并不容易。这是数据团队可以使用[模型注册表](https://web.archive.org/web/20220529051436/https://www.phdata.io/blog/what-is-a-model-registry/)的地方，这是数据科学家存储模型、跟踪性能和其他变化的地方。

跟踪实验使数据团队能够在需要时回滚模型，并改进整个模型审核过程。它减少了数据科学家的大量手动工作，为实验留出了更多时间。所有这些都通过版本控制和跟踪显著提高了结果的可重复性

### 超越 CI/CD

我们已经在开发运维的背景下了解了 CI/CD，但这些也是高成熟度 MLOps 的重要组件。

*   当将 CI 应用于 MLOps 时，我们扩展了代码的自动化测试和验证，以应用于数据和模型。
*   类似地，当管道和模型被重新训练时，CD 概念适用于它们。

我们还可以考虑其他“连续”概念:

*   **连续训练(CT)** :我们已经谈到了当新数据可用时，不断增加的自动化如何允许模型被重新训练。
*   **持续监控(CM)** :重新训练模型的另一个原因是性能下降。我们还应该理解模型是否仍然根据业务度量来交付价值。

在自动化测试中应用连续的概念允许快速的实验，并确保大规模的最小误差。此外，所有四个连续概念的成功实施可以极大地缩短部署时间。

考虑一下我们在自动化部分看到的示例管道。将 CI/CD 概念应用于此将会产生存储在存储库中的代码库。根据 CI，一系列的自动化单元测试将被应用到这个存储库中，例如测试工程化的特性，确保没有丢失的值，以及测试过度拟合。然后可以验证和部署管道的各个组件，确保兼容性和计算需求得到测试和满足。这种程度的自动化支持快速的新部署，使组织能够对外部驱动因素和变化做出反应。

### 采纳组织变革

组织变革必须与 MLOps 成熟度的发展同步进行。这需要促进团队间协作的流程变更，从而打破各自为政的状态。在某些情况下，重组整个团队对于促进一致的 MLOps 成熟度是必要的。微软的成熟度模型涵盖了随着成熟度的提高，人们的行为必须如何改变。

低成熟度环境通常让数据科学家、工程师和软件工程师在孤岛中工作。随着成熟度的提高，每个成员都需要协作。数据科学家和工程师必须合作，将实验代码转换为可重复的管道，而软件和数据工程师必须合作，自动将模型集成到应用程序代码中。

协作的增加使得整个部署过程不再那么依赖一个人。它确保实现团队合作，以减少高成本的手动工作。这些不同领域的专业知识汇集在一起，形成了高成熟度 MLOps 所需的自动化水平。加强协作和自动化对于减少技术债务至关重要。

## MLOps 的兴起仍处于起步阶段

MLOps 诞生于快速有效地部署 ML 模型的需要。随着公司现在大量投资机器学习，越来越多的模型被开发出来，增加了对 MLOps 的需求。虽然 MLOps 仍处于早期阶段，但可以肯定地说，各组织正在寻求围绕一套可以释放机器学习 ROI 的原则进行融合。

如果您有兴趣了解更多关于 MLOps 的信息，您还可以查看以下资源:

*   Noah Gift 的 MLOps 实用指南
*   [与阿莱西娅·维森吉奇一起使用 MLOps 操作机器学习](https://web.archive.org/web/20220529051436/https://www.datacamp.com/community/podcast/operationalizing-machine-learning-with-mlops)
*   [与丹·贝克尔一起从预测到决策](https://web.archive.org/web/20220529051436/https://www.datacamp.com/community/podcast/from-predictions-to-decisions)

