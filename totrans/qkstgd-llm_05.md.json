["```py\nfrom datasets import load_dataset\nimport pandas as pd\n\n# Load the Amazon Reviews Multi-Languages dataset\ndataset = load_dataset(\"amazon_reviews_multi\", \"all_languages\")\n# Convert the 'train' subset of the dataset to a pandas DataFrame\ntraining_df = pd.DataFrame(dataset['train'])\ndef prepare_df_for_openai(df):\n    # Combine 'review_title' and 'review_body' columns, and add a custom suffix '\\n\\n###\\n\\n' at the end to create the 'prompt' column\n    df['prompt'] = df['review_title'] + '\\n\\n' + df['review_body'] + '\\n\\n###\\n\\n'\n    # Create a new 'completion' column by adding a space before the 'stars' values\n    df['completion'] = ' ' + df[stars]\n    # Filter the DataFrame to only include rows with 'language' equal to 'en' (English)\n    english_df = df[df['language'] == 'en']\n    # Remove duplicate rows based on the 'prompt' column\n    english_df.drop_duplicates(subset=['prompt'], inplace=True)\n    # Return the shuffled and filtered DataFrame with only the 'prompt' and 'completion' columns\n    return english_df[['prompt', 'completion']].sample(len(english_df))\n\nenglish_training_df = prepare_df_for_openai(training_df)\n# export the prompts and completions to a JSONL file\nenglish_training_df.to_json(\"amazon-english-full-train-sentiment.jsonl\", orient='records', lines=True)\n```", "```py\n# Execute the 'fine_tunes.create' command using the OpenAI API\n!openai api fine_tunes.create \\\n  # Specify the training dataset file in JSONL format\n  -t \"amazon-english-full-train-sentiment.jsonl\" \\\n  # Specify the validation dataset file in JSONL format\n  -v \"amazon-english-full-val-sentiment.jsonl\" \\\n  # Enable computation of classification metrics after fine-tuning\n  --compute_classification_metrics \\\n  # Set the number of classes for classification (5 in this case)\n  --classification_n_classes 5 \\\n  # Specify the base model to be fine-tuned (using the smallest model, ada)\n  -m ada \\\n  # Set the number of epochs for training (1 in this case)\n  --n_epochs 1\n```", "```py\nimport math\n# Select a random prompt from the test dataset\n\nprompt = english_test_df['prompt'].sample(1).iloc[0]\n\n# Generate a completion using the fine-tuned model\nres = openai.Completion.create(\n    model='ada:ft-personal-2023-03-31-05-30-46', \n    prompt=prompt,\n    max_tokens=1, \n    temperature=0, \n    logprobs=5,\n)\n\n# Initialize an empty list to store probabilities\nprobs = []\n# Extract logprobs from the API response\nlogprobs = res['choices'][0]['logprobs']['top_logprobs']\n# Convert logprobs to probabilities and store them in the 'probs' list\nfor logprob in logprobs:\n    _probs = {}\n    for key, value in logprob.items():\n        _probs[key] = math.exp(value)\n    probs.append(_probs)\n# Extract the predicted category (star) from the API response\npred = res['choices'][0].text.strip()\n# Nicely print the prompt, predicted category, and probabilities\nprint(\"Prompt: \\n\", prompt[:200], \"...\\n\")\nprint(\"Predicted Star:\", pred)\nprint(\"Probabilities:\")\nfor prob in probs:\n    for key, value in sorted(prob.items(), key=lambda x: x[1], reverse=True):\n        print(f\"{key}: {value:.4f}\")\n    print()\n```", "```py\nPrompt:\n Great pieces of jewelry for the price\n\nGreat pieces of jewelry for the price. The 6mm is perfect for my tragus piercing. I gave four stars because I already lost one because it fell out! Other than that I am very happy with the purchase!\n\n###\n\nPredicted Star: 4\nProbabilities:\n 4: 0.9831\n 5: 0.0165\n 3: 0.0002\n 2: 0.0001\n 1: 0.0001\n```"]