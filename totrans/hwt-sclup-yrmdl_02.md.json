["```py\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nbs = np.arange(1, 512)\n\ndef roofline(B, D, F):\n  total_flops = 2*B*D*F\n  flops_time = total_flops / 1.97e14\n  comms_time = (2*B*D + D*F + 2*B*F) / 8.2e11\n  total_time = np.maximum(flops_time, comms_time)\n  return total_flops / total_time\n\nroofline_big = roofline(bs, 4096, 4096)\nroofline_small = roofline(bs, 1024, 1024)\n\nplt.figure(figsize=(8, 4))\nplt.plot(bs, roofline_big, label='F=D=4096')\nplt.plot(bs, roofline_small, label='F=D=1024')\nplt.legend()\nplt.xlabel('batch size')\nplt.ylabel('peak bfloat16 FLOPs/s on TPU v5e')\nplt.grid() \n```", "```py\n Austin et al., \"How to Scale Your Model\", Google DeepMind, online, 2025. \n```", "```py\n @article{scaling-book,\n      title = {How to Scale Your Model},\n      author = {Austin, Jacob and Douglas, Sholto and Frostig, Roy and Levskaya, Anselm and Chen, Charlie and Vikram, Sharad\n      and Lebron, Federico and Choy, Peter and Ramasesh, Vinay and Webson, Albert and Pope, Reiner},\n      publisher = {Google DeepMind},\n      howpublished = {Online},\n      note = {Retrieved from https://jax-ml.github.io/scaling-book/},\n      year = {2025}\n    } \n```"]