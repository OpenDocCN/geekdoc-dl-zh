["```r\nlibrary(torch)\n\na <- 1\nb <- 5\n\nrosenbrock <- function(x) {\n x1 <- x[1]\n x2 <- x[2]\n (a - x1)^2 + b * (x2 - x1^2)^2\n}\n```", "```r\nx <- torch_tensor(c(-1, 1), requires_grad = TRUE)\n```", "```r\nvalue <- rosenbrock(x)\n```", "```r\nvalue$backward()\n```", "```r\nopt <- optim_lbfgs(x)\n```", "```r\nvalue <- rosenbrock(x)\n\nopt$zero_grad()\nvalue$backward()\n\nopt$step()\n```", "```r\ncalc_loss <- function() {\n optimizer$zero_grad()\n value <- rosenbrock(x_star)\n value$backward()\n value\n}\n```", "```r\nfor (i in 1:num_iterations) {\n optimizer$step(calc_loss)\n}\n```", "```r\nnum_iterations <- 2\n\nx <- torch_tensor(c(-1, 1), requires_grad = TRUE)\n\noptimizer <- optim_lbfgs(x)\n\ncalc_loss <- function() {\n optimizer$zero_grad()\n\n value <- rosenbrock(x)\n cat(\"Value is: \", as.numeric(value), \"\\n\")\n\n value$backward()\n value\n}\n\nfor (i in 1:num_iterations) {\n cat(\"\\nIteration: \", i, \"\\n\")\n optimizer$step(calc_loss)\n}\n```", "```r\nIteration:  1 \nValue is:  4 \nValue is:  6 \nValue is:  318.0431 \nValue is:  5.146369 \nValue is:  4.443705 \nValue is:  0.8787204 \nValue is:  0.8543001 \nValue is:  2.001667 \nValue is:  0.5656172 \nValue is:  0.400589 \nValue is:  7.726219 \nValue is:  0.3388008 \nValue is:  0.2861604 \nValue is:  1.951176 \nValue is:  0.2071857 \nValue is:  0.150776 \nValue is:  0.411357 \nValue is:  0.08056168 \nValue is:  0.04880721 \nValue is:  0.0302862 \n\nIteration:  2 \nValue is:  0.01697086 \nValue is:  0.01124081 \nValue is:  0.0006622815 \nValue is:  3.300996e-05 \nValue is:  1.35731e-07 \nValue is:  1.111701e-09 \nValue is:  4.547474e-12 \n```", "```r\nx\n```", "```r\ntorch_tensor\n 1.0000\n 1.0000\n[ CPUFloatType{2} ]\n```", "```r\nnum_iterations <- 2\n\nx <- torch_tensor(c(-1, 1), requires_grad = TRUE)\n\noptimizer <- optim_lbfgs(x, line_search_fn = \"strong_wolfe\")\n\ncalc_loss <- function() {\n optimizer$zero_grad()\n\n value <- rosenbrock(x)\n cat(\"Value is: \", as.numeric(value), \"\\n\")\n\n value$backward()\n value\n}\n\nfor (i in 1:num_iterations) {\n cat(\"\\nIteration: \", i, \"\\n\")\n optimizer$step(calc_loss)\n}\n```", "```r\nIteration:  1 \nValue is:  4 \nValue is:  6 \nValue is:  3.802412 \nValue is:  3.680712 \nValue is:  2.883048 \nValue is:  2.5165 \nValue is:  2.064779 \nValue is:  1.38384 \nValue is:  1.073063 \nValue is:  0.8844351 \nValue is:  0.5554555 \nValue is:  0.2501077 \nValue is:  0.8948895 \nValue is:  0.1619074 \nValue is:  0.06823064 \nValue is:  0.01653575 \nValue is:  0.004060207 \nValue is:  0.00353789 \nValue is:  0.000391416 \nValue is:  4.303527e-06 \nValue is:  2.036851e-08 \nValue is:  6.870948e-12 \n\nIteration:  2 \nValue is:  6.870948e-12 \n```"]