["```py\n[](#cb1-1)pi_logratios = policy_chosen_logps - policy_rejected_logps\n[](#cb1-2)ref_logratios = reference_chosen_logps - reference_rejected_logps\n[](#cb1-3)\n[](#cb1-4)logits = pi_logratios - ref_logratios  # also known as h_{\\pi_\\theta}^{y_w,y_l}\n[](#cb1-5)\n[](#cb1-6)losses = -F.logsigmoid(beta * logits)\n[](#cb1-7)\n[](#cb1-8)chosen_rewards = beta * (policy_chosen_logps - reference_chosen_logps).detach()\n[](#cb1-9)rejected_rewards = beta * (policy_rejected_logps - reference_rejected_logps).detach()\n```"]