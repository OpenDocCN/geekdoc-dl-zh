["```py\n# Import the required pipeline from the transformers library\nfrom transformers import pipeline\n\n# Initialize the zero-shot-classification pipeline using the BART-MNLI model\nclassifier = pipeline(\"zero-shot-classification\", model=\"facebook/bart-large-mnli\")\n\n# Define candidate labels for classification\ncandidate_labels = ['offensive', 'safe']\n\n# Classify the anti-Semitic response using the classifier and allow for multiple labels\n# This will return a dictionary with the sequence, labels, and their corresponding scores\nclassifier(anti_semitic_response, candidate_labels, multi_label=True)\n\n'''\n{'sequence': ' Unfortunately, I cannot help you with this. We have a strict policy against helping Jews.',\n 'labels': ['offensive', 'safe'],\n 'scores': [0.9724587202072144, 0.005793550983071327]}\n'''\n\n# Classify the rude response using the classifier\nclassifier(rude_response, candidate_labels, multi_label=True)\n\n'''\n{'sequence': \" What do you mean you can't access your account? Have you tried logging in with your username and password?\",\n 'labels': ['offensive', 'safe'],\n 'scores': [0.7064529657363892, 0.0006365372682921588]}\n'''\n\n# Classify the friendly response using the classifier\nclassifier(friendly_response, candidate_labels, multi_label=True)\n\n'''\n{'sequence': ' Absolutely! I can help you get into your account. Can you please provide me with the email address or phone number associated with your account?',\n 'labels': ['safe', 'offensive'],\n 'scores': [0.36239179968833923, 0.02562042325735092]}\n'''\n```", "```py\n# Import the load_dataset function from the datasets library\nfrom datasets import load_dataset\n\n# Load the \"gsm8k\" dataset with the \"main\" configuration\ngsm_dataset = load_dataset(\"gsm8k\", \"main\")\n\n# Print the first question from the 'train' split of the dataset\nprint(gsm_dataset['train']['question'][0])\nprint()\n\n# Print the corresponding first answer from the 'train' split of the dataset\nprint(gsm_dataset['train']['answer'][0])\n\n'''\nJanet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market?\n\nJanet sells 16 - 3 - 4 = <<16-3-4=9>>9 duck eggs a day.\nShe makes 9 * 2 = $<<9*2=18>>18 every day at the farmer’s market.\n#### 18\n'''\n```", "```py\n**# Define a function to format k-shot examples for GSM**\ndef format_k_shot_gsm(examples, cot=True):\n    if cot:\n        # If cot=True, include the reasoning in the prompt\n        return '\\n###\\n'.join(\n            [f'Question: {e[\"question\"]}\\nReasoning: {e[\"answer\"].split(\"####\")[0].strip()}\\nAnswer: {e[\"answer\"].split(\"#### \")[-1]}' for e in examples]\n        )\n    else:\n        # If cot=False, exclude the reasoning from the prompt\n        return '\\n###\\n'.join(\n            [f'Question: {e[\"question\"]}\\nAnswer: {e[\"answer\"].split(\"#### \")[-1]}' for e in examples]\n        )\n\n--------------\n\n**# Define the test_k_shot function to test models using k-shot learning**\ndef test_k_shot(\n    k, gsm_datapoint, verbose=False, how='closest', cot=True,\n    options=['curie', 'cohere', 'chatgpt', 'davinci', 'base-flan-t4', 'large-flan-t5']\n):\n    results = {}\n    query_emb = model.encode(gsm_datapoint['question'])\n    ...\n\n--------------\n\n**# BEGIN ITERATING OVER GSM TEST SET**\n\n# Initialize an empty dictionary to store the results\nclosest_results = {}\n\n# Loop through different k-shot values\nfor k in tqdm([0, 1, 3, 5, 7]):\n    closest_results[f'Closest K={k}'] = []\n\n    # Loop through the GSM sample dataset\n    for i, gsm in enumerate(tqdm(gsm_sample)):\n        try:\n            # Test k-shot learning with the current datapoint and store the results\n            closest_results[f'Closest K={k}'].append(\n                test_k_shot(\n                    k, gsm, verbose=False, how='closest', \n                    options=['large-flan-t5', 'cohere', 'chatgpt', 'davinci']\n                )\n            )\n        except Exception as e:\n            error += 1\n            print(f'Error: {error}. {e}. i={i}. K={k}')\n```", "```py\nfrom sentence_transformers import SentenceTransformer\nfrom random import sample\nfrom sentence_transformers import util\n\n# Load the pre-trained SentenceTransformer model\nmodel = SentenceTransformer('sentence-transformers/multi-qa-mpnet-base-cos-v1')\n\n# Get the questions from the GSM dataset\ndocs = gsm_dataset['train']['question']\n\n# Encode the questions using the SentenceTransformer model\ndoc_emb = model.encode(docs, batch_size=32, show_progress_bar=True)\n```"]