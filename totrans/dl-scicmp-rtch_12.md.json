["```r\nlibrary(torch)\n\nloss <- (y_pred - y)$pow(2)$sum()\n```", "```r\nnnf_mse_loss(torch_ones(2, 2), torch_zeros(2, 2) + 0.1)\n```", "```r\ntorch_tensor\n0.81\n[ CPUFloatType{} ]\n```", "```r\nl <- nn_mse_loss()\n```", "```r\nl(torch_ones(2, 2),torch_zeros(2, 2) + 0.1)\n```", "```r\ntorch_tensor\n0.81\n[ CPUFloatType{} ]\n```", "```r\ntarget <- torch_tensor(c(1, 0, 0, 1, 1))\n```", "```r\nunnormalized_estimate <-\n torch_tensor(c(3, 2.7, -1.2, 7.7, 1.9))\n```", "```r\nprobability_estimate <- nnf_sigmoid(unnormalized_estimate)\nprobability_estimate\n```", "```r\ntorch_tensor\n 0.9526\n 0.9370\n 0.2315\n 0.9995\n 0.8699\n[ CPUFloatType{5} ]\n```", "```r\nnnf_binary_cross_entropy_with_logits(\n unnormalized_estimate, target\n)\n```", "```r\ntorch_tensor\n0.643351\n[ CPUFloatType{} ]\n```", "```r\nnnf_binary_cross_entropy(probability_estimate, target)\n```", "```r\ntorch_tensor\n0.643351\n[ CPUFloatType{} ]\n```", "```r\ntarget <- torch_tensor(c(2, 1, 3, 1, 3), dtype = torch_long())\n```", "```r\nunnormalized_estimate <- torch_tensor(\n rbind(c(1.2, 7.7, -1),\n c(1.2, -2.1, -1),\n c(0.2, -0.7, 2.5),\n c(0, -0.3, -1),\n c(1.2, 0.1, 3.2)\n )\n)\n```", "```r\nprobability_estimate <- nnf_softmax(unnormalized_estimate,\n dim = 2\n)\nprobability_estimate\n```", "```r\ntorch_tensor\n 0.0015  0.9983  0.0002\n 0.8713  0.0321  0.0965\n 0.0879  0.0357  0.8764\n 0.4742  0.3513  0.1745\n 0.1147  0.0382  0.8472\n[ CPUFloatType{5,3} ]\n```", "```r\nlogprob_estimate <- nnf_log_softmax(unnormalized_estimate,\n dim = 2\n)\nlogprob_estimate\n```", "```r\ntorch_tensor\n-6.5017 -0.0017 -8.7017\n-0.1377 -3.4377 -2.3377\n-2.4319 -3.3319 -0.1319\n-0.7461 -1.0461 -1.7461\n-2.1658 -3.2658 -0.1658\n[ CPUFloatType{5,3} ]\n```", "```r\nnnf_cross_entropy(unnormalized_estimate, target)\n```", "```r\ntorch_tensor\n0.23665\n[ CPUFloatType{} ]\n```", "```r\nnnf_nll_loss(logprob_estimate, target)\n```", "```r\ntorch_tensor\n0.23665\n[ CPUFloatType{} ]\n```", "```r\ntarget <- torch_tensor(c(1, 0, 0, 1, 1))\n\nunnormalized_estimate <- \n torch_tensor(c(3, 2.7, -1.2, 7.7, 1.9))\n\nprobability_estimate <- nnf_sigmoid(unnormalized_estimate)\n\nnnf_binary_cross_entropy(probability_estimate, target)\n```", "```r\ntorch_tensor\n0.64335\n[ CPUFloatType{} ]\n```", "```r\n# logits\nmulticlass_probability <- torch_tensor(rbind(\n c(1 - 0.9526, 0.9526),\n c(1 - 0.9370, 0.9370),\n c(1 - 0.2315, 0.2315),\n c(1 - 0.9995, 0.9995),\n c(1 - 0.8699, 0.8699)\n))\n```", "```r\ntarget <- target + 1\n```", "```r\nnnf_nll_loss(\n torch_log(multiclass_probability),\n target$to(dtype = torch_long())\n)\n```", "```r\ntorch_tensor\n0.643275\n[ CPUFloatType{} ]\n```"]