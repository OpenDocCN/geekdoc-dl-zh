["```r\nlibrary(torch)\n\nt1 <- torch_tensor(1)\nt1\n```", "```r\ntorch_tensor\n 1\n[ CPUFloatType{1} ]\n```", "```r\nt1$dtype\n```", "```r\ntorch_Float\n```", "```r\nt1$device\n```", "```r\ntorch_device(type='cpu')\n```", "```r\nt1$shape\n```", "```r\n[1] 1\n```", "```r\nt2 <- t1$to(dtype = torch_int())\nt2$dtype\n```", "```r\ntorch_Int\n```", "```r\n# only applicable if you have a GPU\nt2 <- t1$to(device = \"cuda\")\nt2$device\n```", "```r\ntorch_device(type='cuda', index=0)\n```", "```r\nt3 <- t1$view(c(1, 1))\nt3$shape\n```", "```r\n[1] 1 1\n```", "```r\nc(1)\nmatrix(1)\n```", "```r\n[1] 1\n\n     [,1]\n[1,]    1\n```", "```r\ntorch_tensor(1:5)\n```", "```r\ntorch_tensor\n 1\n 2\n 3\n 4\n 5\n[ CPULongType{5} ]\n```", "```r\ntorch_tensor(1:5, dtype = torch_float())\n```", "```r\ntorch_tensor\n 1\n 2\n 3\n 4\n 5\n[ CPUFloatType{5} ]\n```", "```r\ntorch_tensor(1:5, device = \"cuda\")\n```", "```r\ntorch_tensor\n 1\n 2\n 3\n 4\n 5\n[ CPUFloatType{5} ]\n```", "```r\ntorch_tensor(matrix(1:9, ncol = 3))\n```", "```r\ntorch_tensor\n 1  4  7\n 2  5  8\n 3  6  9\n[ CPULongType{3,3} ]\n```", "```r\ntorch_tensor(matrix(1:9, ncol = 3, byrow = TRUE))\n```", "```r\ntorch_tensor\n 1  2  3\n 4  5  6\n 7  8  9\n[ CPULongType{3,3} ]\n```", "```r\ntorch_tensor(array(1:24, dim = c(4, 3, 2)))\n```", "```r\ntorch_tensor\n(1,.,.) = \n   1  13\n   5  17\n   9  21\n\n(2,.,.) = \n   2  14\n   6  18\n  10  22\n\n(3,.,.) = \n   3  15\n   7  19\n  11  23\n\n(4,.,.) = \n   4  16\n   8  20\n  12  24\n[ CPULongType{4,3,2} ]\n```", "```r\narray(1:24, dim = c(4, 3, 2))\n```", "```r\n, , 1\n\n     [,1] [,2] [,3]\n[1,]    1    5    9\n[2,]    2    6   10\n[3,]    3    7   11\n[4,]    4    8   12\n\n, , 2\n\n     [,1] [,2] [,3]\n[1,]   13   17   21\n[2,]   14   18   22\n[3,]   15   19   23\n[4,]   16   20   24\n```", "```r\ntorch_randn(3, 3)\n```", "```r\ntorch_tensor\n-0.6532  0.6557  2.0251\n-0.7914 -1.7220  1.0387\n 0.1931  1.0536 -0.2077\n[ CPUFloatType{3,3} ]\n```", "```r\ntorch_rand(3, 3)\n```", "```r\ntorch_tensor\n 0.2498  0.5356  0.6515\n 0.3556  0.5799  0.1284\n 0.9884  0.4361  0.8040\n[ CPUFloatType{3,3} ]\n```", "```r\ntorch_zeros(2, 5)\n```", "```r\ntorch_tensor\n 0  0  0  0  0\n 0  0  0  0  0\n[ CPUFloatType{2,5} ]\n```", "```r\ntorch_ones(2, 2)\n```", "```r\ntorch_tensor\n 1  1\n 1  1\n[ CPUFloatType{2,2} ]\n```", "```r\ntorch_eye(n = 5)\n```", "```r\ntorch_tensor\n 1  0  0  0  0\n 0  1  0  0  0\n 0  0  1  0  0\n 0  0  0  1  0\n 0  0  0  0  1\n[ CPUFloatType{5,5} ]\n```", "```r\ntorch_diag(c(1, 2, 3))\n```", "```r\ntorch_tensor\n 1  0  0\n 0  2  0\n 0  0  3\n[ CPUFloatType{3,3} ]\n```", "```r\nJohnsonJohnson\n```", "```r\n Qtr1  Qtr2  Qtr3  Qtr4\n1960  0.71  0.63  0.85  0.44\n1961  0.61  0.69  0.92  0.55\n1962  0.72  0.77  0.92  0.60\n1963  0.83  0.80  1.00  0.77\n1964  0.92  1.00  1.24  1.00\n1965  1.16  1.30  1.45  1.25\n1966  1.26  1.38  1.86  1.56\n1967  1.53  1.59  1.83  1.86\n1968  1.53  2.07  2.34  2.25\n1969  2.16  2.43  2.70  2.25\n1970  2.79  3.42  3.69  3.60\n1971  3.60  4.32  4.32  4.05\n1972  4.86  5.04  5.04  4.41\n1973  5.58  5.85  6.57  5.31\n1974  6.03  6.39  6.93  5.85\n1975  6.93  7.74  7.83  6.12\n1976  7.74  8.91  8.28  6.84\n1977  9.54 10.26  9.54  8.73\n1978 11.88 12.06 12.15  8.91\n1979 14.04 12.96 14.85  9.99\n1980 16.20 14.67 16.02 11.61\n```", "```r\ntorch_tensor(JohnsonJohnson)\n```", "```r\ntorch_tensor\n  0.7100\n  0.6300\n  0.8500\n  0.4400\n  0.6100\n  0.6900\n  0.9200\n  0.5500\n  0.7200\n  0.7700\n  0.9200\n  0.6000\n  0.8300\n  0.8000\n  1.0000\n  0.7700\n  0.9200\n  1.0000\n  1.2400\n  1.0000\n  1.1600\n  1.3000\n  1.4500\n  1.2500\n  1.2600\n  1.3800\n  1.8600\n  1.5600\n  1.5300\n  1.5900\n... [the output was truncated (use n=-1 to disable)]\n[ CPUFloatType{84} ]\n```", "```r\nunclass(JohnsonJohnson)\n```", "```r\n[1]  0.71  0.63  0.85  0.44  0.61  0.69  0.92  0.55  0.72\n[10] 0.77  0.92  0.60  0.83  0.80  1.00  0.77 0.92  1.00\n[19] 1.24  1.00  1.16  1.30  1.45  1.25  1.26  1.38  1.86\n[28] 1.56  1.53  1.59  1.83  1.86 1.53  2.07  2.34  2.25\n[37] 2.16  2.43  2.70  2.25  2.79  3.42  3.69  3.60  3.60\n[46] 4.32  4.32  4.05 4.86  5.04  5.04  4.41  5.58  5.85\n[55] 6.57  5.31  6.03  6.39  6.93  5.85  6.93  7.74  7.83\n[64] 6.12 7.74  8.91  8.28  6.84  9.54 10.26  9.54  8.73\n[73] 11.88 12.06 12.15  8.91 14.04 12.96 14.85  9.99 16.20\n[82] 14.67 16.02 11.61 \nattr(,\"tsp\")\n[1] 1960.00 1980.75    4.00\n```", "```r\nlibrary(dplyr)\n\nglimpse(Orange)\n```", "```r\nRows: 35\nColumns: 3\n$ Tree          <ord> 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2,...\n$ age           <dbl> 118, 484, 664, 1004, 1231, 1372, 1582,...\n$ circumference <dbl> 30, 58, 87, 115, 120, 142, 145, 33, 69,...\n```", "```r\ntorch_tensor(Orange)\n```", "```r\nError in torch_tensor_cpp(data, dtype, device, requires_grad,\npin_memory) : R type not handled\n```", "```r\nf <- factor(c(\"a\", \"b\", \"c\"), ordered = TRUE)\ntorch_tensor(f)\n```", "```r\ntorch_tensor\n 1\n 2\n 3\n[ CPULongType{3} ]\n```", "```r\norange_ <- Orange %>% \n mutate(Tree = as.numeric(Tree)) %>%\n as.matrix()\n\ntorch_tensor(orange_) %>% print(n = 7)\n```", "```r\ntorch_tensor\n    2   118    30\n    2   484    58\n    2   664    87\n    2  1004   115\n    2  1231   120\n    2  1372   142\n    2  1582   145\n... [the output was truncated (use n=-1 to disable)]\n[ CPUFloatType{35,3} ]\n```", "```r\nlibrary(modeldata)\n\ndata(okc)\nokc %>% glimpse()\n```", "```r\nRows: 59,855\nColumns: 6\n$ age      <int> 22, 35, 38, 23, 29, 29, 32, 31, 24,...\n$ diet     <chr> \"strictly anything\", \"mostly other\",...\n$ height   <int> 75, 70, 68, 71, 66, 67, 65, 65, 67, 65,...\n$ location <chr> \"south san francisco\", \"oakland\",... \n$ date     <date> 2012-06-28, 2012-06-29, 2012-06-27,...\n$ Class    <fct> other, other, other, other, other, stem,...\n```", "```r\nprint(torch_tensor(okc$date), n = 7)\n```", "```r\ntorch_tensor\n 15519\n 15520\n 15518\n 15519\n 15518\n 15520\n 15516\n... [the output was truncated (use n=-1 to disable)]\n[ CPUFloatType{59855} ]\n```", "```r\ntorch_tensor(okc$location)\n```", "```r\nError in torch_tensor_cpp(data, dtype, device, requires_grad,\npin_memory) : R type not handled\n```", "```r\nokc$location %>%\n factor() %>%\n as.numeric() %>%\n torch_tensor() %>%\n print(n = 7)\n```", "```r\ntorch_tensor\n 120\n  74\n 102\n  10\n 102\n 102\n 102\n... [the output was truncated (use n=-1 to disable)]\n[ CPUFloatType{59855} ]\n```", "```r\ntorch_tensor(c(1, NA, 3))\n```", "```r\ntorch_tensor\n 1\nnan\n 3\n[ CPUFloatType{3} ]\n```", "```r\ntorch_nanquantile(torch_tensor(c(1, NA, 3)), q = 0.5)\n```", "```r\ntorch_tensor\n 2\n[ CPUFloatType{1} ]\n```", "```r\nt1 <- torch_tensor(c(1, 2))\nt2 <- torch_tensor(c(3, 4))\n\ntorch_add(t1, t2)\n# equivalently\nt1$add(t2)\n```", "```r\ntorch_tensor\n 4\n 6\n[ CPUFloatType{2} ]\n```", "```r\nt1$add_(t2)\n```", "```r\ntorch_tensor\n 4\n 6\n[ CPUFloatType{2} ]\n```", "```r\nt1\n```", "```r\ntorch_tensor\n 4\n 6\n[ CPUFloatType{2} ]\n```", "```r\nt1 <- torch_tensor(1:3)\nt2 <- torch_tensor(4:6)\nt1$dot(t2)\n```", "```r\ntorch_tensor\n32\n[ CPULongType{} ]\n```", "```r\nt1$t()$dot(t2)\n```", "```r\ntorch_tensor\n32\n[ CPULongType{} ]\n```", "```r\nt3 <- torch_tensor(matrix(1:12, ncol = 3, byrow = TRUE))\nt3$matmul(t1)\n```", "```r\ntorch_tensor\n 14\n 32\n 50\n 68\n[ CPULongType{4} ]\n```", "```r\ntorch_multiply(t1, t2)\n```", "```r\ntorch_tensor\n  4\n 10\n 18\n[ CPULongType{3} ]\n```", "```r\nm <- outer(1:3, 1:6)\n\nsum(m)\napply(m, 1, sum)\napply(m, 2, sum)\n```", "```r\n[1] 126\n[1]  21 42 63\n[1]   6 12 18 24 30 36\n```", "```r\nt <- torch_outer(torch_tensor(1:3), torch_tensor(1:6))\nt$sum()\n```", "```r\ntorch_tensor\n126\n[ CPULongType{} ]\n```", "```r\nt$sum(dim = 1)\n```", "```r\ntorch_tensor\n  6\n 12\n 18\n 24\n 30\n 36\n[ CPULongType{6} ]\n```", "```r\nt$sum(dim = 2)\n```", "```r\ntorch_tensor\n 21\n 42\n 63\n[ CPULongType{3} ]\n```", "```r\nt <- torch_randn(4, 3, 2)\nt\n```", "```r\ntorch_tensor\n(1,.,.) = \n -1.3427  1.1303\n  1.0430  0.8232\n  0.7952 -0.2447\n\n(2,.,.) = \n -1.9929  0.1251\n  0.4143  0.3523\n  0.9819  0.3219\n\n(3,.,.) = \n  0.6389 -0.2606\n  2.4011  0.2656\n -0.1750 -0.2597\n\n(4,.,.) = \n  1.4534  0.7229\n  1.2503 -0.2975\n  1.6749 -1.2154\n[ CPUFloatType{4,3,2} ]\n```", "```r\nt$mean(dim = c(1, 2))\n```", "```r\ntorch_tensor\n-0.1600\n 0.1363\n[ CPUFloatType{2} ]\n```", "```r\nt$mean(dim = 2)\n```", "```r\ntorch_tensor\n-0.6153  0.8290\n 0.3961  0.2739\n-0.0579  0.1966\n-0.3628 -0.7544\n[ CPUFloatType{4,2} ]\n```", "```r\nt <- torch_tensor(matrix(1:9, ncol = 3, byrow = TRUE))\nt[1, ]\n```", "```r\ntorch_tensor\n 1\n 2\n 3\n[ CPULongType{3} ]\n```", "```r\nt[1, , drop = FALSE]\n```", "```r\ntorch_tensor\n 1  2  3\n[ CPULongType{1,3} ]\n```", "```r\nt <- torch_rand(3, 3, 3)\nt[1:2, 2:3, c(1, 3)]\n```", "```r\ntorch_tensor\n(1,.,.) = \n  0.5273  0.3781\n  0.5303  0.9537\n\n(2,.,.) = \n  0.2966  0.7160\n  0.5421  0.4284\n[ CPUFloatType{2,2,2} ]\n```", "```r\nt <- torch_tensor(matrix(1:4, ncol = 2, byrow = TRUE))\nt[-1, -1]\n```", "```r\ntorch_tensor\n4\n[ CPULongType{} ]\n```", "```r\nt <- torch_tensor(matrix(1:20, ncol = 10, byrow = TRUE))\nt[ , 1:8:2]\n```", "```r\ntorch_tensor\n  1   3   5   7\n 11  13  15  17\n[ CPULongType{2,4} ]\n```", "```r\nt[1, ..]\n```", "```r\nt1 <- torch_randn(2, 2)\nt2 <- torch_randn(2, 2, 2)\nt3 <- torch_randn(2, 2, 2, 2)\nt1[1, ..]\nt2[1, ..]\nt3[1, ..]\n```", "```r\ntorch_tensor\n-0.6179\n-1.4769\n[ CPUFloatType{2} ]\n\ntorch_tensor\n 1.0602 -0.9028\n 0.2942  0.4611\n[ CPUFloatType{2,2} ]\n\ntorch_tensor\n(1,.,.) = \n  1.3304 -0.6018\n  0.0825  0.1221\n\n(2,.,.) = \n  1.7129  1.2932\n  0.2371  0.9041\n[ CPUFloatType{2,2,2} ]\n```", "```r\nt3[1, .., 2]\n```", "```r\ntorch_tensor\n-0.6018  0.1221\n 1.2932  0.9041\n[ CPUFloatType{2,2} ]\n```", "```r\nt <- torch_zeros(24)\nprint(t, n = 3)\n```", "```r\ntorch_tensor\n 0\n 0\n 0\n... [the output was truncated (use n=-1 to disable)]\n[ CPUFloatType{24} ]\n```", "```r\nt2 <- t$view(c(2, 12))\nt2\n```", "```r\ntorch_tensor\n 0  0  0  0  0  0  0  0  0  0  0  0\n 0  0  0  0  0  0  0  0  0  0  0  0\n[ CPUFloatType{2,12} ]\n```", "```r\nt$storage()$data_ptr()\nt2$storage()$data_ptr()\n```", "```r\n[1] \"0x55cd15789180\"\n[1] \"0x55cd15789180\"\n```", "```r\nt <- torch_tensor(matrix(1:15, nrow = 3, byrow = TRUE))\nt\n```", "```r\n torch_tensor\n  1   2   3   4   5\n  6   7   8   9  10\n 11  12  13  14  15\n[ CPULongType{3,5} ]\n```", "```r\nt$stride()\n```", "```r\n[1] 5 1\n```", "```r\nt2 <- t$view(c(5, 3))\nt2\n```", "```r\ntorch_tensor\n  1   2   3\n  4   5   6\n  7   8   9\n 10  11  12\n 13  14  15\n[ CPULongType{5,3} ]\n```", "```r\nt2$stride()\n```", "```r\n[1] 3 1\n```", "```r\nt3 <- t$t()\nt3\n```", "```r\ntorch_tensor\n  1   6  11\n  2   7  12\n  3   8  13\n  4   9  14\n  5  10  15\n[ CPULongType{5,3} ]\n```", "```r\nt$storage()$data_ptr()\nt3$storage()$data_ptr()\n```", "```r\n[1] \"0x55cd1cd4a840\"\n[1] \"0x55cd1cd4a840\"\n```", "```r\nt3$stride()\n```", "```r\n[1] 1 5\n```", "```r\nt <- torch_randn(3)\nt\n\nt$unsqueeze(1)\n```", "```r\ntorch_tensor\n 0.2291\n-0.9454\n 1.6630\n[ CPUFloatType{3} ]\n\ntorch_tensor\n 0.2291 -0.9454  1.6630\n[ CPUFloatType{1,3} ]\n```", "```r\nt <- torch_randn(3, 3)\nt$t()$view(9)\n```", "```r\n Error in (function (self, size)  : \n  view size is not compatible with input tensor's size and\n  stride (at least one dimension spans across two contiguous\n  subspaces). Use .reshape(...) instead. [...]\n```", "```r\nt <- torch_randn(3, 3)\nt2 <- t$t()$reshape(9)\n\nt$storage()$data_ptr()\nt2$storage()$data_ptr()\n```", "```r\n[1] \"0x55cd1622a000\"\n[1] \"0x55cd19d31e40\"\n```", "```r\nt1 <- torch_randn(3, 5)\nt1 * 0.5\n```", "```r\ntorch_tensor\n-0.4845  0.3092 -0.3710  0.3558 -0.2126\n-0.3419  0.1160  0.1800 -0.0094 -0.0189\n-0.0468 -0.4030 -0.3172 -0.1558 -0.6247\n[ CPUFloatType{3,5} ]\n```", "```r\nm <- matrix(1:15, ncol = 5, byrow = TRUE)\nm2 <- matrix(1:5, ncol = 5, byrow = TRUE)\n\nm + m2\n```", "```r\nError in m + m2 : non-conformable arrays\n```", "```r\nm3 <- 1:5\n\nm + m3\n```", "```r\n [,1] [,2] [,3] [,4] [,5]\n[1,]    2    6    5    9    8\n[2,]    8   12   11   10   14\n[3,]   14   13   17   16   20\n```", "```r\nt <- torch_tensor(m)\nt2 <- torch_tensor(m2)\n\nt$shape\nt2$shape\n\nt$add(t2)\n```", "```r\ntorch_tensor\n  2   4   6   8  10\n  7   9  11  13  15\n 12  14  16  18  20\n[ CPULongType{3,5} ]\n```", "```r\nt3 <- torch_tensor(m3)\n\nt3$shape\n\nt$add(t3)\n```", "```r\n[1] 5\ntorch_tensor\n  2   4   6   8  10\n  7   9  11  13  15\n 12  14  16  18  20\n[ CPULongType{3,5} ]\n```", "```r\n# t1, shape:        3  7  1\n# t2, shape:           1  5\n```", "```r\n# t1, shape:        3  7  5\n# t2, shape:           7  5\n```", "```r\n# t1, shape:        3  7  5\n# t2, shape:        1  7  5\n```", "```r\n# t1, shape:        3  7  5\n# t2, shape:        3  7  5\n```", "```r\ntorch_zeros(4, 3, 2, 1)$add(torch_ones(4, 3, 2)) # error!\n```"]