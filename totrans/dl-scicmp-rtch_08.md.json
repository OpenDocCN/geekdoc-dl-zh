["```r\na <- 1\nb <- 5\n\nrosenbrock <- function(x) {\n x1 <- x[1]\n x2 <- x[2]\n (a - x1)^2 + b * (x2 - x1^2)^2\n}\n```", "```r\nlibrary(torch)\n\n# attention: this is not the correct procedure yet!\n\nfor (i in 1:num_iterations) {\n\n # call function, passing in current parameter value\n value <- rosenbrock(x)\n\n # compute gradient of value w.r.t. parameter\n value$backward()\n\n # manually update parameter, subtracting a fraction\n # of the gradient\n # this is not quite correct yet!\n x$sub_(lr * x$grad)\n}\n```", "```r\nlr <- 0.01\n\nnum_iterations <- 1000\n```", "```r\nx <- torch_tensor(c(-1, 1), requires_grad = TRUE)\n```", "```r\nwith_no_grad({\n x$sub_(lr * x$grad)\n x$grad$zero_()\n})\n```", "```r\nnum_iterations <- 1000\n\nlr <- 0.01\n\nx <- torch_tensor(c(-1, 1), requires_grad = TRUE)\n\nfor (i in 1:num_iterations) {\n if (i %% 100 == 0) cat(\"Iteration: \", i, \"\\n\")\n\n value <- rosenbrock(x)\n if (i %% 100 == 0) {\n cat(\"Value is: \", as.numeric(value), \"\\n\")\n }\n\n value$backward()\n if (i %% 100 == 0) {\n cat(\"Gradient is: \", as.matrix(x$grad), \"\\n\")\n }\n\n with_no_grad({\n x$sub_(lr * x$grad)\n x$grad$zero_()\n })\n}\n```", "```r\nIteration:  100 \nValue is:  0.3502924 \nGradient is:  -0.667685 -0.5771312 \n\nIteration:  200 \nValue is:  0.07398106 \nGradient is:  -0.1603189 -0.2532476 \n\nIteration:  300 \nValue is:  0.02483024 \nGradient is:  -0.07679074 -0.1373911 \n\nIteration:  400 \nValue is:  0.009619333 \nGradient is:  -0.04347242 -0.08254051 \n\nIteration:  500 \nValue is:  0.003990697 \nGradient is:  -0.02652063 -0.05206227 \n\nIteration:  600 \nValue is:  0.001719962 \nGradient is:  -0.01683905 -0.03373682 \n\nIteration:  700 \nValue is:  0.0007584976 \nGradient is:  -0.01095017 -0.02221584 \n\nIteration:  800 \nValue is:  0.0003393509 \nGradient is:  -0.007221781 -0.01477957\n\nIteration:  900 \nValue is:  0.0001532408 \nGradient is:  -0.004811743 -0.009894371 \n\nIteration:  1000 \nValue is:  6.962555e-05 \nGradient is:  -0.003222887 -0.006653666 \n```", "```r\nx\n```", "```r\ntorch_tensor\n 0.9918\n 0.9830\n[ CPUFloatType{2} ]\n```"]