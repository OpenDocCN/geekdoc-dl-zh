["```r\nds <- dataset()(\n initialize = function(...) {\n ...\n },\n .getitem = function(index) {\n ...\n },\n .length = function() {\n ...\n }\n)\n```", "```r\nlibrary(torch)\nlibrary(palmerpenguins)\nlibrary(dplyr)\n\npenguins %>% glimpse()\n```", "```r\n$ species           <fct> Adelie, Adelie, Adelie, Adelie,...\n$ island            <fct> Torgersen, Torgersen, Torgersen,...\n$ bill_length_mm    <dbl> 39.1, 39.5, 40.3, NA, 36.7, 39.3,...\n$ bill_depth_mm     <dbl> 18.7, 17.4, 18.0, NA, 19.3, 20.6,...\n$ flipper_length_mm <int> 181, 186, 195, NA, 193, 190, 181,...\n$ body_mass_g       <int> 3750, 3800, 3250, NA, 3450, 3650,...\n$ sex               <fct> male, female, female, NA, female,...\n$ year              <int> 2007, 2007, 2007, 2007, 2007,...\n```", "```r\npenguins_dataset <- dataset(\n name = \"penguins_dataset()\",\n initialize = function(df) {\n df <- na.omit(df)\n self$x <- as.matrix(df[, 3:6]) %>% torch_tensor()\n self$y <- torch_tensor(\n as.numeric(df$species)\n )$to(torch_long())\n },\n .getitem = function(i) {\n list(x = self$x[i, ], y = self$y[i])\n },\n .length = function() {\n dim(self$x)[1]\n }\n)\n```", "```r\nds <- penguins_dataset(penguins)\nlength(ds)\n```", "```r\n[1] 333\n```", "```r\nds[1]\n```", "```r\n$x\ntorch_tensor\n   39.1000\n   18.7000\n  181.0000\n 3750.0000\n[ CPUFloatType{4} ]\n\n$y\ntorch_tensor\n1\n[ CPULongType{} ]\n```", "```r\nthree <- tensor_dataset(\n torch_randn(10), torch_randn(10), torch_randn(10)\n)\nthree[1]\n```", "```r\n[[1]]\ntorch_tensor\n0.522735\n[ CPUFloatType{} ]\n\n[[2]]\ntorch_tensor\n-0.976477\n[ CPUFloatType{} ]\n\n[[3]]\ntorch_tensor\n-1.14685\n[ CPUFloatType{} ]\n```", "```r\npenguins <- na.omit(penguins)\nds <- tensor_dataset(\n torch_tensor(as.matrix(penguins[, 3:6])),\n torch_tensor(\n as.numeric(penguins$species)\n )$to(torch_long())\n)\n\nds[1]\n```", "```r\nlibrary(torchvision)\n\ndir <- \"~/.torch-datasets\"\n\nds <- mnist_dataset(\n root = dir,\n train = TRUE, # default\n download = TRUE,\n transform = function(x) {\n x %>% transform_to_tensor() \n }\n)\n\nfirst <- ds[1]\ncat(\"Image shape: \", first$x$shape, \" Label: \", first$y, \"\\n\")\n```", "```r\nImage shape:  1 28 28  Label:  6 \n```", "```r\ndl <- dataloader(ds, batch_size = 32, shuffle = TRUE)\n```", "```r\nlength(dl)\n```", "```r\n[1] 1875\n```", "```r\nfirst_batch <- dl %>%\n # obtain an iterator for this dataloader\n dataloader_make_iter() %>% \n dataloader_next()\n\ndim(first_batch$x)\ndim(first_batch$y)\n```", "```r\n[1] 32  1 28 28\n[1] 32\n```"]